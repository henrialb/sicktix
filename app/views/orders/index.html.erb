<%= render '../views/shared/forms/form_top'%>

<h1><%= @event.name %></h1>
<h1><%= @event.starts_at %></h1>
<h1>Orders</h1>

<table class="table table-striped mt-3 mb-3 bg-white rounded">

  <thead class="thead-light">
    <tr>
      <th scope="col">Order id</th>
      <% @event.event_categories.each do |category| %>
        <th scope="col">
          <%= category.name %>
          (€<%= category.price %>/p)
        </th>
      <% end %>
      <th>Order total</th>
    </tr>
  </thead>

  <tbody>

    <tr>
      <th scope="col">Total</th>
        <% @event.event_categories.each do |category| %>
          <th scope="col"><%= category.tickets.count %></th>
        <% end %>
      <th scope="col">€<%= total_revenue(@event) %></th>
    </tr>

    <% @event.orders.each do |order| %>
      <tr>
        <th scope="col">
          <%= order.id %>
        </th>
        <% @event.event_categories.each do |category| %>
          <th scope="col">
            <%= order.inventory[category.id] %>
          </th>
        <% end %>
        <th scope="col">
          €<%= order.tickets.map { |ticket| ticket.event_category.price }.sum %>
        </th>
      </tr>
    <% end %>

  </tbody>
</table>

<%= render '../views/shared/forms/form_bottom'%>
